%form#form{role: 'form', action: xml_xmldsig_sign_path, method: 'post', data: {remote: true} }
  %div.row

    %div.col-md-6
      = render 'concerns/panels/form', |
        header: t('.xml'),             |
        body: render('concerns/editors/input', id: 'input_xml_editor', |
          name: 'xml',                                               |
          options: { mode: 'xml' },                                    |
          content: get_sample_xml('xmldsig.xml'))

    %div.col-md-6
      = render 'concerns/panels/form', |
        header: t('.output'),             |
        body: render('concerns/editors/output', id: 'output_xml_editor', |
          name: 'output',                                                |
          options: { mode: 'xml' })

  %div.row
    %div.col-md-1
      = render 'concerns/buttons/submit', |
        text:  t('.form_submit.label'), disable_with: t('.form_submit.disable')

  %div.row
    %div.col-md-6
      - content_for :settings do
        = settings_radio_button_tag(name: 'provider', label: t('.provider.label'), default: 'bicrypt_fpsu',
          options: {'bicrypt_fpsu' => t('.provider.bicrypt_fpsu.label'),
                    'bicrypt_local_single_component_key' => t('.provider.bicrypt_local_single_component_key.label'),
                    'bicrypt_local_double_component_key' => t('.provider.bicrypt_local_double_component_key.label'),
                    'rsa' => t('.provider.rsa.label'),
                    },
          input_attrs: {'data-master' => 'true'})

        %span{style: 'display: none', data: {'master-name' => 'provider', 'master-values' => 'rsa'}}
          = render 'concerns/uploads/list', |
            name: 'rsa_pkcs12_file', label: t('.rsa_pkcs12_file.label'), files: @files.all { |f| f.uploaded_file_name.match(/.?\.p12/) }
        
        = settings_text_field_tag(name: 'rsa_pkcs12_password', label: t('.rsa_pkcs12_password.label'), type: 'password', default: '123456',
          div_attrs: {class: 'clear', style: 'display: none', data: {'master-name' => 'provider', 'master-values' => 'rsa'}})
        -#= settings_text_field_tag(name: 'rsa_pkcs12_alias', label: t('.rsa_pkcs12_alias.label'), 'data-master-name' => 'provider', 'data-master-values' => ['rsa'], class: 'clear provider_input rsa', display: 'none', default: '1')

        = settings_text_field_tag(name: 'bicrypt_fpsu_host', label: t('.bicrypt_fpsu_host.label'), default: '10.76.112.249',
          div_attrs: {class: 'clear', data: {'master-name' => 'provider', 'master-values' => 'bicrypt_fpsu'}})
        = settings_text_field_tag(name: 'bicrypt_fpsu_port', label: t('.bicrypt_fpsu_port.label'), default: 850,
          div_attrs: {class: 'clear', data: {'master-name' => 'provider', 'master-values' => 'bicrypt_fpsu'}})
        = settings_text_field_tag(name: 'bicrypt_fpsu_timeout', label: t('.bicrypt_fpsu_timeout.label'), default: 200,
          div_attrs: {class: 'clear', data: {'master-name' => 'provider', 'master-values' => 'bicrypt_fpsu'}})
        = settings_text_field_tag(name: 'bicrypt_fpsu_key_number', label: t('.bicrypt_fpsu_key_number.label'), default: 10,
          div_attrs: {class: 'clear', data: {'master-name' => 'provider', 'master-values' => 'bicrypt_fpsu'}})

        %span{style: 'display: none', data: {'master-name' => 'provider', 'master-values' => 'bicrypt_local_double_component_key bicrypt_local_single_component_key'}}
          = render 'concerns/uploads/list', |
            name: 'bicrypt_local_pk_file', label: t('.bicrypt_local_pk_file.label'), files: @files.all { |f| f.uploaded_file_name.match(/.?\.key/) }
        
        %span{style: 'display: none', data: {'master-name' => 'provider', 'master-values' => 'bicrypt_local_double_component_key'}}
          = render 'concerns/uploads/list', |
            name: 'bicrypt_local_double_mk_file', label: t('.bicrypt_local_double_mk_file.label'), files: @files.all { |f| f.uploaded_file_name.match(/.?\.key/) }
          
        = settings_text_field_tag(name: 'bicrypt_local_single_pk_password', label: t('.bicrypt_local_single_pk_password.label'), type: 'password', default: 'ER2iHk',
          div_attrs: {class: 'clear', style: 'display: none', data: {'master-name' => 'provider', 'master-values' => 'provider_input bicrypt_local_single_component_key'}})
        
        %span{style: 'display: none', data: {'master-name' => 'provider', 'master-values' => 'provider_input bicrypt_local_double_component_key bicrypt_local_single_component_key'}}
          = render 'concerns/uploads/list', |
            name: 'bicrypt_local_gk_file', label: t('.bicrypt_local_gk_file.label'), files: @files.all { |f| f.uploaded_file_name.match(/.?gk.?\.db3/) }
        
        %span{style: 'display: none', data: {'master-name' => 'provider', 'master-values' => 'provider_input bicrypt_local_double_component_key bicrypt_local_single_component_key'}}
          = render 'concerns/uploads/list', |
            name: 'bicrypt_local_uz_file', label: t('.bicrypt_local_uz_file.label'), files: @files.all { |f| f.uploaded_file_name.match(/.?uz.?\.db3/) }

        %span{style: 'display: none', data: {'master-name' => 'provider', 'master-values' => 'provider_input bicrypt_local_double_component_key bicrypt_local_single_component_key'}}
          = render 'concerns/uploads/list', |
            name: 'bicrypt_local_prnd_file', label: t('.bicrypt_local_prnd_file.label'), files: @files.all { |f| f.uploaded_file_name.match(/.?prnd.?\.db3/) }
      
      = render 'concerns/panels/form', |
        header: t('.settings'),        |
        body: yield(:settings)

    %div.col-md-6
      = render 'concerns/panels/form', |
        header: t('.file_upload'),     |
        body: render('concerns/uploads/form', id: 'fileupload', |
          tooltip: (t('concerns.uploads.form.tooltip') + ' ' + t('.prolog_note')))

= javascript_include_tag 'views/xml/xmldsig'
